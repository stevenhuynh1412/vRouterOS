# Hướng dẫn các lệnh cấu hình trong vRouterOS

## Giới thiệu

Trong **vRouterOS**, các lệnh cấu hình được sử dụng để quản lý và thay đổi cấu hình của hệ thống. Các lệnh này được thực thi trong **chế độ cấu hình** hoặc **chế độ vận hành**, tùy thuộc vào tác vụ. Tài liệu này mô tả các lệnh cấu hình chính, cú pháp, và cách sử dụng chúng để quản lý hệ thống vRouterOS.

Trong tài liệu này:
- **Chế độ vận hành**: Các lệnh bắt đầu bằng ký hiệu `$`.
- **Chế độ cấu hình**: Các lệnh bắt đầu bằng ký hiệu `#`.

## Các lệnh cấu hình cơ bản

### 1. Chuyển sang chế độ cấu hình
- **Lệnh**:
  ```
  $ configure
  ```
- **Mô tả**: Chuyển từ chế độ vận hành sang chế độ cấu hình để chỉnh sửa cấu hình làm việc.
- **Ví dụ**:
  ```
  $ configure
  # 
  ```
  - Dấu nhắc lệnh thay đổi từ `$` sang `#`, cho biết bạn đang ở chế độ cấu hình.

### 2. Thêm hoặc sửa đổi cấu hình
- **Lệnh**:
  ```
  # set <path> <value>
  ```
- **Mô tả**: Thêm hoặc sửa đổi một câu lệnh cấu hình trong cấu hình làm việc. `<path>` là đường dẫn đến node cấu hình, và `<value>` là giá trị được gán.
- **Ví dụ**:
  ```
  # set interfaces dataplane dp0s3 address 192.0.2.1/24
  ```
  - Đặt địa chỉ IP `192.0.2.1/24` cho giao diện `dp0s3`.

### 3. Xóa cấu hình
- **Lệnh**:
  ```
  # delete <path> [<value>]
  ```
- **Mô tả**: Xóa một node hoặc giá trị cụ thể khỏi cấu hình làm việc. Nếu không chỉ định `<value>`, toàn bộ node sẽ bị xóa.
- **Ví dụ**:
  ```
  # delete interfaces dataplane dp0s3 address 192.0.2.1/24
  ```
  - Xóa địa chỉ IP cụ thể.
  ```
  # delete interfaces dataplane dp0s3
  ```
  - Xóa toàn bộ cấu hình của giao diện `dp0s3`.

### 4. Áp dụng thay đổi
- **Lệnh**:
  ```
  # commit
  ```
- **Mô tả**: Áp dụng các thay đổi từ cấu hình làm việc vào cấu hình đang chạy, làm cho chúng có hiệu lực ngay lập tức.
- **Ví dụ**:
  ```
  # commit
  ```
  - Nếu cấu hình hợp lệ, thay đổi được áp dụng. Nếu không, lỗi sẽ được hiển thị.

### 5. Xem cấu hình
- **Lệnh**:
  - Trong chế độ cấu hình:
    ```
    # show [<path>]
    ```
  - Trong chế độ vận hành:
    ```
    $ show configuration
    $ show configuration commands
    ```
- **Mô tả**:
  - `show` trong chế độ cấu hình hiển thị cấu hình làm việc.
  - `show configuration` trong chế độ vận hành hiển thị cấu hình đang chạy ở định dạng cây.
  - `show configuration commands` hiển thị cấu hình dưới dạng các lệnh `set`.
- **Ví dụ**:
  ```
  # show interfaces dataplane dp0s3
  address 192.0.2.1/24
  ```
  ```
  $ show configuration commands
  set interfaces dataplane dp0s3 address '192.0.2.1/24'
  ```

### 6. So sánh cấu hình
- **Lệnh**:
  ```
  # compare
  ```
- **Mô tả**: Hiển thị sự khác biệt giữa cấu hình làm việc và cấu hình đang chạy, cho biết các thay đổi chưa được commit.
- **Ví dụ**:
  ```
  # compare
  + interfaces dataplane dp0s3 address 192.0.2.1/24
  - interfaces dataplane dp0s4 address 198.51.100.1/24
  ```
  - `+` chỉ các node/gía trị được thêm; `-` chỉ các node/gía trị bị xóa.

### 7. Hủy bỏ thay đổi
- **Lệnh**:
  ```
  # discard
  ```
- **Mô tả**: Hủy bỏ tất cả các thay đổi chưa commit trong cấu hình làm việc, đưa nó về trạng thái giống cấu hình đang chạy.
- **Ví dụ**:
  ```
  # discard
  ```

### 8. Lưu cấu hình
- **Lệnh**:
  ```
  $ save [<file>]
  ```
- **Mô tả**: Lưu cấu hình đang chạy vào file, mặc định là `/config/config.boot`. Có thể chỉ định file khác.
- **Ví dụ**:
  ```
  $ save
  Saving configuration to '/config/config.boot'...
  Done
  ```
  ```
  $ save /config/myconfig.conf
  ```

### 9. Tải cấu hình
- **Lệnh**:
  ```
  $ load <file>
  ```
- **Mô tả**: Tải cấu hình từ file vào cấu hình làm việc. Sau khi tải, cần chạy `commit` để áp dụng.
- **Ví dụ**:
  ```
  $ load /config/myconfig.conf
  $ configure
  # commit
  ```

### 10. Thoát chế độ cấu hình
- **Lệnh**:
  ```
  # exit
  ```
- **Mô tả**: Thoát khỏi chế độ cấu hình, trở về chế độ vận hành. Nếu có thay đổi chưa commit, hệ thống sẽ cảnh báo.
- **Ví dụ**:
  ```
  # exit
  exit
  Configuration changes have not been committed. Exit anyway? [yes/no] yes
  ```

## Ví dụ thực tế

### Cấu hình giao diện với địa chỉ IP
1. Vào chế độ cấu hình:
   ```
   $ configure
   ```
2. Thêm địa chỉ IP:
   ```
   # set interfaces dataplane dp0s3 address 192.0.2.1/24
   ```
3. Kiểm tra:
   ```
   # show interfaces dataplane dp0s3
   address 192.0.2.1/24
   ```
4. Áp dụng:
   ```
   # commit
   ```
5. Lưu:
   ```
   # save
   Saving configuration to '/config/config.boot'...
   Done
   ```
6. Thoát:
   ```
   # exit
   ```

### Xóa địa chỉ IP và kiểm tra
1. Vào chế độ cấu hình:
   ```
   $ configure
   ```
2. Xóa địa chỉ:
   ```
   # delete interfaces dataplane dp0s3 address 192.0.2.1/24
   ```
3. So sánh thay đổi:
   ```
   # compare
   - interfaces dataplane dp0s3 address 192.0.2.1/24
   ```
4. Áp dụng:
   ```
   # commit
   ```
5. Lưu:
   ```
   # save
   ```

## Lưu ý quan trọng
- **Commit cẩn thận**: Các thay đổi được commit sẽ có hiệu lực ngay lập tức. Cấu hình sai có thể gây mất kết nối hoặc lỗi hệ thống.
- **Sao lưu trước khi thay đổi**: Luôn sao lưu cấu hình:
  ```
  $ save /config/backup-YYYYMMDD.conf
  ```
- **Kiểm tra lỗi**: Nếu `commit` thất bại, đọc thông báo lỗi để sửa cấu hình.
- **Tài liệu tham khảo**: Xem thêm chi tiết trên trang tài liệu vRouterOS hoặc các tài liệu liên quan trên https://docs.fwcloud.co

## Kết luận
Các lệnh cấu hình trong vRouterOS cho phép quản lý hệ thống một cách linh hoạt thông qua chế độ vận hành và cấu hình. Sử dụng các lệnh như `set`, `delete`, `commit`, `save`, và `load` để thực hiện các thay đổi hiệu quả. Thực hành các ví dụ trên để làm quen với quy trình.